<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anscript Hub | Zoom Effect</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.0/vanilla-tilt.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --accent: #00ff96; 
            --bg: #050505; 
            --card-bg: rgba(20, 20, 20, 0.8);
            --neon-shadow: 0 0 20px rgba(0, 255, 150, 0.3);
        }

        body { 
            background: var(--bg); color: #fff; font-family: 'Quicksand', sans-serif; 
            margin: 0; overflow-x: hidden;
        }

        /* --- Navbar --- */
        .navbar {
            display: flex; align-items: center; justify-content: space-between;
            padding: 15px 6%; background: rgba(0,0,0,0.9);
            backdrop-filter: blur(15px); border-bottom: 1px solid rgba(0,255,150,0.2);
            position: sticky; top: 0; z-index: 1000;
        }

        /* --- Sidebar --- */
        .sidebar {
            position: fixed; top: 0; left: -100%; width: 280px; height: 100%;
            background: rgba(10,10,10,0.98); z-index: 2000; padding: 40px 25px;
            border-right: 2px solid var(--accent); transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .sidebar.active { left: 0; }
        
        .tab-item {
            padding: 15px; margin-bottom: 12px; border-radius: 12px;
            border: 1px solid #222; cursor: pointer; text-align: center;
            transition: 0.3s; position: relative;
        }
        .tab-item.active { 
            background: var(--accent); color: #000; font-weight: bold;
            box-shadow: var(--neon-shadow); border-color: var(--accent);
        }

        /* --- Hiệu ứng Grid --- */
        .grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
            gap: 25px; padding: 40px 6%;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s;
        }

        /* Lớp hiệu ứng thu nhỏ */
        .grid.zoom-out {
            transform: scale(0.3);
            opacity: 0;
        }

        /* Lớp hiệu ứng phóng to */
        .grid.zoom-in {
            animation: zoomInEffect 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes zoomInEffect {
            from { transform: scale(0.3); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* --- Card UI --- */
        .card {
            background: var(--card-bg); border-radius: 18px; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.05); cursor: pointer;
            transition: 0.3s;
        }
        .card:hover { border-color: var(--accent); box-shadow: var(--neon-shadow); }
        .card-img { width: 100%; height: 100%; object-fit: cover; }
        .card-name { padding: 10px; text-align: center; font-family: 'Orbitron'; font-size: 0.8rem; color: var(--accent); }

        /* Aspect Ratios */
        .ratio-1-1 { aspect-ratio: 1/1; }
        .ratio-16-9 { aspect-ratio: 16/9; }
        .ratio-9-16 { aspect-ratio: 9/16; }

        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 3000; justify-content: center; align-items: center; }
        .modal-content { background: #111; border: 1px solid var(--accent); padding: 25px; border-radius: 20px; width: 90%; max-width: 400px; text-align: center; }
    </style>
</head>
<body>

    <div class="navbar">
        <button onclick="toggleSidebar(true)" style="background:none; border:none; color:var(--accent); font-size:1.8rem; cursor:pointer">☰</button>
        <div style="font-family:'Orbitron'; color:var(--accent); letter-spacing:3px; font-size:1.5rem;">AN HUB</div>
        <div></div> </div>

    <div id="side" class="sidebar">
        <h2 style="color:var(--accent); font-family:'Orbitron'; text-align:center;">TẬP TIN</h2>
        <div id="tList"></div>
    </div>

    <div class="grid" id="g"></div>

    <div id="m" class="modal">
        <div class="modal-content">
            <img id="mI" style="width:100%; border-radius:10px; margin-bottom:15px">
            <h2 id="mT" style="color:var(--accent); margin:0"></h2>
            <p id="mD" style="color:#aaa; font-size:0.9rem; margin:15px 0"></p>
            <button onclick="copy()" style="width:100%; padding:12px; background:var(--accent); border:none; border-radius:10px; font-weight:bold; cursor:pointer">COPY SCRIPT</button>
            <button onclick="document.getElementById('m').style.display='none'" style="width:100%; margin-top:10px; background:none; border:none; color:#555; cursor:pointer">Đóng</button>
        </div>
    </div>

    <script>
        const API = window.location.origin;
        const DEF = "https://media.discordapp.net/attachments/1472992341156434219/1472992415303340276/Picsart_26-02-16_14-27-25-185.jpg";
        let db = [], curT = "ALL", curC = "";

        async function init() {
            const r = await fetch(`${API}/get-hub`);
            const d = await r.json();
            db = d.scripts || [];
            renderTabs(d.tabs || []);
            renderCards(db);
        }

        function toggleSidebar(open) {
            document.getElementById('side').classList.toggle('active', open);
        }

        function renderTabs(ts) {
            const list = document.getElementById('tList');
            list.innerHTML = `<div class="tab-item active" onclick="setTab('ALL', this)">TẤT CẢ</div>`;
            ts.forEach(t => {
                list.innerHTML += `<div class="tab-item" onclick="setTab('${t.Name}', this)">${t.Name}</div>`;
            });
        }

        function setTab(t, el) {
            if (curT === t) return;
            curT = t;

            // Đánh dấu Tab active
            document.querySelectorAll('.tab-item').forEach(b => b.classList.remove('active'));
            el.classList.add('active');

            const grid = document.getElementById('g');

            // 1. Thu nhỏ danh sách cũ
            grid.classList.add('zoom-out');

            setTimeout(() => {
                // 2. Đóng Sidebar
                toggleSidebar(false);

                // 3. Lọc và Render dữ liệu mới
                const f = db.filter(s => (curT === "ALL" || s.tab === curT));
                renderCards(f);

                // 4. Phóng to danh sách mới ra
                grid.classList.remove('zoom-out');
                grid.classList.add('zoom-in');

                // Xóa class zoom-in sau khi xong để lần sau dùng tiếp
                setTimeout(() => grid.classList.remove('zoom-in'), 600);
            }, 500); // Đợi hiệu ứng thu nhỏ chạy xong
        }

        function renderCards(ss) {
            const g = document.getElementById('g'); g.innerHTML = "";
            ss.forEach(s => {
                let imgPath = (s.img && s.img !== "") ? s.img : DEF;
                const ratio = s.ratio || "ratio-1-1";
                const card = document.createElement('div');
                card.className = `card ${ratio}`;
                card.innerHTML = `
                    <img src="${imgPath}" class="card-img" onerror="this.src='${DEF}'">
                    <div class="card-name">${s.name}</div>
                `;
                card.onclick = () => {
                    document.getElementById('mT').innerText = s.name;
                    document.getElementById('mI').src = imgPath;
                    document.getElementById('mD').innerText = s.describe || "";
                    curC = s.script;
                    document.getElementById('m').style.display = 'flex';
                };
                g.appendChild(card);
            });
            VanillaTilt.init(document.querySelectorAll(".card"), { max: 15, speed: 400 });
        }

        function copy() { navigator.clipboard.writeText(curC); alert("Copied!"); }

        init();
    </script>
</body>
</html>
