<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anscript Hub</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.0/vanilla-tilt.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00ff96; --bg: #0a0a0a; --glow: 0 0 15px rgba(0, 255, 150, 0.4); }
        body { background: var(--bg); color: #eee; font-family: 'Quicksand', sans-serif; margin: 0; }
        
        /* Navbar */
        .navbar { display: flex; align-items: center; justify-content: space-between; padding: 15px 5%; background: #000; border-bottom: 1px solid var(--accent); position: sticky; top: 0; z-index: 100; }
        .logo { font-family: 'Orbitron'; color: var(--accent); text-shadow: var(--glow); font-size: 1.2rem; }
        
        /* Search Box */
        .search-container { display: flex; align-items: center; }
        .search-input { width: 0; opacity: 0; transition: 0.4s; border: none; outline: none; background: #222; color: white; border-radius: 20px; }
        .search-container.active .search-input { width: 180px; opacity: 1; padding: 5px 15px; border: 1px solid var(--accent); }
        .search-btn { background: none; border: none; color: var(--accent); font-size: 1.3rem; cursor: pointer; }

        /* Menu Overlay */
        .menu-btn { background: none; border: none; color: var(--accent); font-size: 1.5rem; cursor: pointer; }
        .tabs-overlay { position: fixed; top: 0; left: -100%; width: 250px; height: 100%; background: #111; z-index: 200; transition: 0.3s; padding: 20px; border-right: 1px solid var(--accent); }
        .tabs-overlay.active { left: 0; }
        .tab-item { display: block; width: 100%; padding: 10px; margin-bottom: 10px; background: #222; border: 1px solid #333; color: white; cursor: pointer; border-radius: 5px; }
        .tab-item.active { border-color: var(--accent); color: var(--accent); }

        /* Grid & Cards */
        .script-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; padding: 20px; }
        .script-card { background: #1a1a1a; border-radius: 10px; overflow: hidden; border: 1px solid #333; cursor: pointer; position: relative; }
        .ratio-1-1 { aspect-ratio: 1/1; }
        .ratio-16-9 { aspect-ratio: 16/9; }
        .ratio-9-16 { aspect-ratio: 9/16; }
        .card-img { width: 100%; height: 100%; object-fit: cover; }
        .card-name { position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.7); padding: 5px; text-align: center; font-size: 0.8rem; }

        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 300; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { background: #111; border: 1px solid var(--accent); padding: 20px; border-radius: 15px; width: 100%; max-width: 400px; text-align: center; }
    </style>
</head>
<body>
    <div class="navbar">
        <button class="menu-btn" onclick="document.getElementById('sideMenu').classList.add('active')">‚ò∞</button>
        <div class="logo">AN HUB</div>
        <div class="search-container" id="searchBox">
            <input type="text" id="searchInput" class="search-input" placeholder="T√¨m script..." oninput="applyFilter()">
            <button class="search-btn" onclick="toggleSearch()">üîç</button>
        </div>
    </div>

    <div id="sideMenu" class="tabs-overlay">
        <button style="float:right; color:red; background:none; border:none;" onclick="document.getElementById('sideMenu').classList.remove('active')">X</button>
        <h3>TABS</h3>
        <div id="tabList"></div>
    </div>

    <div class="script-grid" id="mainGrid"></div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <img id="mImg" style="width:100%; border-radius:10px; margin-bottom:15px">
            <h2 id="mTitle"></h2>
            <p id="mDesc" style="font-size:0.8rem; color:#aaa; white-space:pre-line"></p>
            <button onclick="copyCode()" style="width:100%; padding:10px; background:var(--accent); border:none; border-radius:5px; font-weight:bold; cursor:pointer">COPY SCRIPT</button>
            <button onclick="document.getElementById('modal').style.display='none'" style="margin-top:10px; background:none; border:none; color:#777; cursor:pointer">ƒê√≥ng</button>
        </div>
    </div>

    <script>
        const API = window.location.origin;
        const DEFAULT_IMG = "https://media.discordapp.net/attachments/1472992341156434219/1472992415303340276/Picsart_26-02-16_14-27-25-185.jpg";
        let allData = [], curTab = "ALL", curCode = "";

        async function start() {
            const res = await fetch(`${API}/get-hub`);
            const data = await res.json();
            allData = data.scripts || [];
            renderTabs(data.tabs || []);
            renderCards(allData);
        }

        function renderTabs(tabs) {
            const list = document.getElementById('tabList');
            list.innerHTML = `<div class="tab-item" onclick="setTab('ALL')">T·∫•t c·∫£</div>`;
            tabs.forEach(t => list.innerHTML += `<div class="tab-item" onclick="setTab('${t.Name}')">${t.Name}</div>`);
        }

        function renderCards(scripts) {
            const grid = document.getElementById('mainGrid');
            grid.innerHTML = scripts.length ? "" : "<p>Tr·ªëng...</p>";
            scripts.forEach(s => {
                const img = s.img || DEFAULT_IMG;
                const ratio = s.ratio || "ratio-1-1";
                grid.innerHTML += `
                    <div class="script-card ${ratio}" onclick="openModal('${s.name}','${img}','${s.script}','${s.describe}')">
                        <img src="${img}" class="card-img" onerror="this.src='${DEFAULT_IMG}'">
                        <div class="card-name">${s.name}</div>
                    </div>`;
            });
            VanillaTilt.init(document.querySelectorAll(".script-card"), { max: 15, speed: 400 });
        }

        function setTab(t) { curTab = t; document.getElementById('sideMenu').classList.remove('active'); applyFilter(); }
        function toggleSearch() { document.getElementById('searchBox').classList.toggle('active'); }
        function applyFilter() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            const filtered = allData.filter(s => (curTab === "ALL" || s.tab === curTab) && s.name.toLowerCase().includes(q));
            renderCards(filtered);
        }
        function openModal(n,i,c,d) {
            document.getElementById('mTitle').innerText = n;
            document.getElementById('mImg').src = i;
            document.getElementById('mDesc').innerText = d;
            curCode = c;
            document.getElementById('modal').style.display = 'flex';
        }
        function copyCode() { navigator.clipboard.writeText(curCode); alert("ƒê√£ copy!"); }
        start();
    </script>
</body>
</html>
