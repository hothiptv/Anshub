<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Anscript Hub V3 | THE NEXT GEN</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Montserrat:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --accent: #00ff96; 
            --accent-rgb: 0, 255, 150;
            --bg: #050505; 
            --glass: rgba(255, 255, 255, 0.03);
            --glow: 0 0 25px rgba(0, 255, 150, 0.4);
            --anim-speed: 0.6s;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body { 
            background: var(--bg); color: #fff; font-family: 'Montserrat', sans-serif; 
            margin: 0; overflow-x: hidden; min-height: 100vh;
        }

        #star-canvas { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at center, #0a1a12 0%, #030303 100%); }

        /* --- UI WRAPPER & SEARCH ANIMATION --- */
        #app-wrapper { transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), filter 0.6s; }
        body.searching #app-wrapper { transform: scale(0.9) translateY(-20px); filter: blur(5px); pointer-events: none; }

        /* --- NAVBAR --- */
        .navbar { 
            display: flex; align-items: center; justify-content: space-between; 
            padding: 15px 25px; background: rgba(0,0,0,0.8); backdrop-filter: blur(20px); 
            border-bottom: 1px solid rgba(var(--accent-rgb), 0.1); position: sticky; top: 0; z-index: 1000;
        }
        .logo { font-family: 'Orbitron'; color: var(--accent); font-size: 1.2rem; font-weight: 900; letter-spacing: 4px; text-shadow: var(--glow); }

        /* --- SIDEBAR --- */
        .sidebar { 
            position: fixed; top: 0; left: -100%; width: 300px; height: 100%; 
            background: rgba(5,5,5,0.98); z-index: 2000; padding: 40px 25px; 
            transition: 0.7s cubic-bezier(0.85, 0, 0.15, 1); border-right: 1px solid var(--accent);
        }
        .sidebar.active { left: 0; box-shadow: 20px 0 100px rgba(0,0,0,0.8); }
        .tab-item { 
            padding: 18px; margin-bottom: 15px; border-radius: 15px; background: var(--glass);
            cursor: pointer; transition: 0.4s; display: flex; justify-content: space-between; align-items: center;
            text-transform: uppercase; font-size: 0.75rem; font-weight: 800; border: 1px solid transparent;
            opacity: 0; transform: translateX(-20px);
        }
        .sidebar.active .tab-item { opacity: 1; transform: translateX(0); }
        .tab-item:hover { border-color: var(--accent); background: rgba(var(--accent-rgb), 0.05); }
        .tab-item.active { background: var(--accent); color: #000; box-shadow: var(--glow); }
        .tab-count { font-size: 10px; background: rgba(0,0,0,0.2); padding: 4px 8px; border-radius: 20px; }

        /* --- HOME TAB --- */
        .home-section { padding: 40px 25px; text-align: center; animation: fadeIn 1s; }
        .profile-img { 
            width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--accent);
            box-shadow: var(--glow); margin-bottom: 20px; object-fit: cover;
        }
        .intro-card { 
            background: var(--glass); padding: 25px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.05);
            margin: 20px 0; position: relative; overflow: hidden;
        }
        .intro-banner { width: 100%; border-radius: 15px; margin-bottom: 20px; border: 1px solid #222; }
        .admin-info { font-size: 14px; line-height: 2; color: #ccc; }
        .admin-info b { color: var(--accent); font-family: 'Orbitron'; }
        
        .btn-start { 
            background: var(--accent); color: #000; padding: 18px 40px; border: none; border-radius: 50px;
            font-family: 'Orbitron'; font-weight: 900; cursor: pointer; margin-top: 30px; 
            box-shadow: var(--glow); transition: 0.3s;
        }
        .btn-start:hover { transform: scale(1.1); filter: brightness(1.2); }

        /* --- ALL TAB (HORIZONTAL SCROLL) --- */
        .section-container { margin-bottom: 40px; }
        .section-header { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0 25px; margin-bottom: 15px; 
        }
        .section-title { font-family: 'Orbitron'; font-size: 0.9rem; color: var(--accent); letter-spacing: 2px; }
        .horizontal-scroll { 
            display: flex; overflow-x: auto; gap: 20px; padding: 10px 25px 20px; 
            scrollbar-width: none; -webkit-overflow-scrolling: touch;
        }
        .horizontal-scroll::-webkit-scrollbar { display: none; }

        /* --- CARDS --- */
        .card { 
            flex: 0 0 160px; aspect-ratio: 1/1; background: var(--card-bg); border-radius: 22px; 
            overflow: hidden; border: 1px solid rgba(255,255,255,0.05); position: relative;
            transition: 0.4s cubic-bezier(0.23, 1, 0.32, 1); backdrop-filter: blur(10px);
        }
        .card:hover { transform: scale(1.05); border-color: var(--accent); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .card-img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .card-info { 
            position: absolute; inset: 0; background: linear-gradient(to top, #000, transparent);
            display: flex; align-items: flex-end; justify-content: center; padding: 15px;
        }
        .card-name { font-size: 10px; font-family: 'Orbitron'; font-weight: 700; color: var(--accent); text-align: center; }

        /* --- SEARCH OVERLAY --- */
        #search-overlay {
            position: fixed; inset: 0; z-index: 5000; display: none;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .search-circle {
            width: 60px; height: 60px; background: var(--accent); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            transition: 0.6s cubic-bezier(0.85, 0, 0.15, 1);
        }
        body.searching #search-overlay { display: flex; }
        .search-expanded { 
            width: 85% !important; height: 55px !important; border-radius: 30px !important; 
            padding: 0 20px; background: #fff !important; 
        }
        #search-input { 
            width: 100%; background: none; border: none; font-size: 18px; 
            font-family: 'Montserrat'; font-weight: 700; display: none; 
        }
        #search-results-container {
            position: fixed; bottom: 40px; width: 100%; opacity: 0; transform: translateY(50px);
            transition: 0.5s;
        }
        body.searching #search-results-container { opacity: 1; transform: translateY(0); }

        /* --- MODAL --- */
        .modal { 
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); 
            z-index: 6000; justify-content: center; align-items: center; padding: 25px; backdrop-filter: blur(15px);
        }
        .modal-content { 
            background: #0d0d0d; border: 1px solid var(--accent); padding: 35px; 
            border-radius: 30px; width: 100%; max-width: 400px; text-align: center;
            animation: modalIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes modalIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .icon-btn { background: none; border: none; color: var(--accent); font-size: 1.5rem; cursor: pointer; }

        /* Ratios */
        .ratio-1-1 { flex-basis: 160px; aspect-ratio: 1/1; }
        .ratio-16-9 { flex-basis: 240px; aspect-ratio: 16/9; }
    </style>
</head>
<body>

<canvas id="star-canvas"></canvas>

<div id="search-overlay">
    <div class="search-circle" id="sCircle">
        <input type="text" id="search-input" placeholder="B·∫°n t√¨m g√¨ th·∫ø?..." oninput="handleRealSearch()">
        <span id="sIcon" style="color:#000; font-size: 24px;">üîç</span>
    </div>
    <div id="search-results-container">
        <div class="section-header">
            <span class="section-title">RESULTS (<span id="sCount">0</span>)</span>
            <button class="icon-btn" onclick="closeSearch()" style="color:#ff4d4d">√ó</button>
        </div>
        <div class="horizontal-scroll" id="sRes"></div>
    </div>
</div>

<div id="app-wrapper">
    <div class="navbar">
        <button class="icon-btn" onclick="toggleMenu(true)">‚ò∞</button>
        <div class="logo">ANSHUB</div>
        <button class="icon-btn" onclick="openSearch()">üîç</button>
    </div>

    <div id="content-home" class="tab-content home-section">
        <img src="https://i.ibb.co/60cyM2Dk/image.png" class="profile-img">
        <h2 style="font-family:'Orbitron'; letter-spacing: 2px;">WELCOME BACK</h2>
        <div class="intro-card">
            <img src="https://i.ibb.co/FkXTHyfw/image.png" class="intro-banner">
            <div class="admin-info">
                Nh√≥m: <b>Anscript VN</b><br>
                Admin: <b>Hothiptv</b><br>
                Status: <b>Active & Updates</b><br>
                Anscript Hub (Anshub) - T·ªïng h·ª£p Script ch·∫•t l∆∞·ª£ng cao.
            </div>
        </div>
        <button class="btn-start" onclick="goToAll()">B·∫ÆT ƒê·∫¶U NGAY</button>
    </div>

    <div id="content-all" class="tab-content" style="display:none; padding-top: 20px;">
        <div id="all-rows-container"></div>
    </div>
</div>

<div id="side" class="sidebar">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px">
        <h2 style="color:var(--accent); font-family:'Orbitron'; font-size: 1rem;">MENU</h2>
        <button class="icon-btn" onclick="toggleMenu(false)" style="color:#ff4d4d">√ó</button>
    </div>
    <div class="sidebar-content">
        <div class="tab-item active" id="tab-home-btn" onclick="switchTab('HOME')">HOME</div>
        <div class="tab-item" id="tab-all-btn" onclick="switchTab('ALL')">
            ALL SCRIPTS <span class="tab-count" id="count-all">0</span>
        </div>
        <div id="dynamic-tabs"></div>
    </div>
</div>

<div id="m" class="modal">
    <div class="modal-content">
        <img id="mI" style="width:100%; border-radius:20px; margin-bottom:20px;">
        <h2 id="mT" style="color:var(--accent); font-family:'Orbitron';"></h2>
        <p id="mD" style="color:#aaa; font-size:13px; line-height:1.6"></p>
        <button class="btn-start" style="width:100%" onclick="copyCode()">COPY SCRIPT</button>
        <button onclick="closeModal()" style="background:none; border:none; color:#444; margin-top:20px; cursor:pointer">ƒê√ìNG</button>
    </div>
</div>

<script>
    const API = window.location.origin;
    const DEF_IMG = "https://i.ibb.co/szRg104/image.png";
    let db = [], tabs = [], curC = "";

    async function init() {
        initStars();
        try {
            const r = await fetch(`${API}/get-hub`);
            const data = await r.json();
            db = data.scripts || [];
            tabs = data.tabs || [];
            
            // Render Menu Sidebar
            const dyn = document.getElementById('dynamic-tabs');
            document.getElementById('count-all').innerText = db.length;
            
            // ∆Øu ti√™n ƒë∆∞a Anscript l√™n ƒë·∫ßu
            tabs.sort((a,b) => a.Name === "Anscript" ? -1 : 1);

            tabs.forEach((t, i) => {
                const count = db.filter(s => s.tab === t.Name).length;
                const item = document.createElement('div');
                item.className = 'tab-item';
                item.style.transitionDelay = `${i*0.1}s`;
                item.innerHTML = `${t.Name} <span class="tab-count">${count}</span>`;
                item.onclick = () => { switchTab('ALL'); setTimeout(() => {
                    document.getElementById(`row-${t.Name}`).scrollIntoView({behavior:'smooth'});
                }, 500); };
                dyn.appendChild(item);
            });

            renderAllSections();
        } catch(e) { console.log(e) }
    }

    function renderAllSections() {
        const container = document.getElementById('all-rows-container');
        container.innerHTML = "";

        tabs.forEach(t => {
            const scripts = db.filter(s => s.tab === t.Name);
            if(scripts.length === 0) return;

            const section = document.createElement('div');
            section.className = 'section-container';
            section.id = `row-${t.Name}`;
            section.innerHTML = `
                <div class="section-header">
                    <span class="section-title">${t.Name.toUpperCase()}</span>
                    <span style="font-size:10px; color:#444">${scripts.length} SCRIPTS</span>
                </div>
                <div class="horizontal-scroll">
                    ${scripts.map(s => `
                        <div class="card ${s.ratio || 'ratio-1-1'}" onclick="openModal('${s.name}', '${s.img}', '${s.describe}', '${s.script}')">
                            <img src="${s.img || DEF_IMG}" class="card-img">
                            <div class="card-info"><div class="card-name">${s.name}</div></div>
                        </div>
                    `).join('')}
                </div>
            `;
            container.appendChild(section);
        });
    }

    function switchTab(type) {
        document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
        document.querySelectorAll('.tab-item').forEach(b => b.classList.remove('active'));
        
        if(type === 'HOME') {
            document.getElementById('content-home').style.display = 'block';
            document.getElementById('tab-home-btn').classList.add('active');
        } else {
            document.getElementById('content-all').style.display = 'block';
            document.getElementById('tab-all-btn').classList.add('active');
        }
        toggleMenu(false);
    }

    function goToAll() { switchTab('ALL'); }

    function openSearch() {
        document.body.classList.add('searching');
        const circle = document.getElementById('sCircle');
        const input = document.getElementById('search-input');
        const icon = document.getElementById('sIcon');
        
        setTimeout(() => {
            circle.classList.add('search-expanded');
            icon.style.display = 'none';
            input.style.display = 'block';
            input.focus();
        }, 100);
    }

    function closeSearch() {
        document.body.classList.remove('searching');
        const circle = document.getElementById('sCircle');
        circle.classList.remove('search-expanded');
        document.getElementById('search-input').style.display = 'none';
        document.getElementById('sIcon').style.display = 'block';
        document.getElementById('sRes').innerHTML = "";
    }

    function handleRealSearch() {
        const key = document.getElementById('search-input').value.toLowerCase();
        const filtered = db.filter(s => s.name.toLowerCase().includes(key));
        document.getElementById('sCount').innerText = filtered.length;
        
        const res = document.getElementById('sRes');
        res.innerHTML = filtered.map(s => `
            <div class="card ratio-1-1" onclick="openModal('${s.name}', '${s.img}', '${s.describe}', '${s.script}')">
                <img src="${s.img || DEF_IMG}" class="card-img">
                <div class="card-info"><div class="card-name">${s.name}</div></div>
            </div>
        `).join('');
    }

    function openModal(n, i, d, s) {
        document.getElementById('mT').innerText = n;
        document.getElementById('mI').src = i || DEF_IMG;
        document.getElementById('mD').innerText = d || "High quality script by AnsHub.";
        curC = s;
        document.getElementById('m').style.display = 'flex';
    }

    function closeModal() { document.getElementById('m').style.display = 'none'; }
    
    function copyCode() {
        navigator.clipboard.writeText(curC).then(() => alert("COPIED!"));
    }

    function toggleMenu(o) { document.getElementById('side').classList.toggle('active', o); }

    function initStars() {
        const canvas = document.getElementById('star-canvas');
        const ctx = canvas.getContext('2d');
        let stars = [];
        const resize = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
        window.addEventListener('resize', resize); resize();
        for(let i=0; i<100; i++) stars.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, s:Math.random()*2, o:Math.random()});
        const anim = () => {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            stars.forEach(s => {
                ctx.fillStyle = `rgba(0, 255, 150, ${s.o})`;
                ctx.beginPath(); ctx.arc(s.x, s.y, s.s, 0, Math.PI*2); ctx.fill();
                s.y -= 0.2; if(s.y<0) s.y=canvas.height;
            });
            requestAnimationFrame(anim);
        }; anim();
    }

    init();
</script>
</body>
</html>
