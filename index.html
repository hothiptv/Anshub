<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anscript Hub v0.1</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.0/vanilla-tilt.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00ff96; --bg: #0a0a0a; --glow: 0 0 15px rgba(0, 255, 150, 0.4); --text: #e0e0e0; }
        * { box-sizing: border-box; }
        body { background: var(--bg); color: var(--text); font-family: 'Quicksand', sans-serif; margin: 0; overflow-x: hidden; }

        /* Navbar & Controls */
        .navbar { display: flex; align-items: center; justify-content: space-between; padding: 15px 5%; background: rgba(0,0,0,0.8); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(0,255,150,0.2); }
        .logo { font-family: 'Orbitron'; color: var(--accent); font-size: 1.2rem; text-shadow: var(--glow); }

        .nav-right { display: flex; align-items: center; gap: 15px; }

        /* Search Box Animation */
        .search-container { display: flex; align-items: center; position: relative; }
        .search-input { 
            width: 0; padding: 0; border: none; background: #222; color: white; 
            border-radius: 20px; transition: all 0.4s ease; outline: none; opacity: 0;
        }
        .search-container.active .search-input { width: 200px; padding: 8px 15px; opacity: 1; border: 1px solid var(--accent); }
        .search-btn { background: none; border: none; color: var(--accent); font-size: 1.5rem; cursor: pointer; }

        /* Menu Tabs */
        .menu-toggle { background: none; border: none; color: var(--accent); font-size: 1.5rem; cursor: pointer; }
        .tabs-overlay { 
            position: fixed; top: 60px; left: -100%; width: 250px; height: 100%; 
            background: #111; transition: 0.3s; padding: 20px; z-index: 99; border-right: 1px solid var(--accent);
        }
        .tabs-overlay.open { left: 0; }
        .tab-btn { 
            display: block; width: 100%; padding: 12px; margin-bottom: 10px; background: none; 
            border: 1px solid #333; color: white; text-align: left; border-radius: 8px; cursor: pointer; 
        }
        .tab-btn.active { border-color: var(--accent); color: var(--accent); box-shadow: var(--glow); }

        /* Grid & Cards */
        .script-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; padding: 20px 5%; }
        
        /* Aspect Ratio Classes */
        .script-card { background: rgba(255,255,255,0.05); border-radius: 12px; overflow: hidden; border: 1px solid rgba(0,255,150,0.1); cursor: pointer; transition: 0.3s; }
        .ratio-1-1 { aspect-ratio: 1/1; }
        .ratio-16-9 { aspect-ratio: 16/9; }
        .ratio-9-16 { aspect-ratio: 9/16; }

        .card-img { width: 100%; height: 100%; object-fit: cover; }
        .card-name { padding: 10px; text-align: center; background: rgba(0,0,0,0.6); font-size: 0.8rem; font-weight: bold; }

        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { background: #111; width: 100%; max-width: 400px; padding: 20px; border-radius: 15px; border: 1px solid var(--accent); }
    </style>
</head>
<body>

    <div class="navbar">
        <button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>
        <div class="logo">AN HUB</div>
        <div class="nav-right">
            <div class="search-container" id="searchContainer">
                <input type="text" class="search-input" id="searchInput" placeholder="T√¨m script..." onblur="closeSearch()">
                <button class="search-btn" onclick="toggleSearch()">üîç</button>
            </div>
        </div>
    </div>

    <div class="tabs-overlay" id="tabsOverlay">
        <h3 style="color:var(--accent)">CHUY√äN M·ª§C</h3>
        <div id="tabList"></div>
    </div>

    <div class="script-grid" id="grid"></div>

    <div id="infoModal" class="modal">
        <div class="modal-content">
            <img id="modalImg" style="width:100%; border-radius:10px">
            <h2 id="modalTitle" style="color:var(--accent)"></h2>
            <p id="modalDesc"></p>
            <button onclick="copyScript()" style="width:100%; padding:10px; background:var(--accent); border:none; font-weight:bold">COPY SCRIPT</button>
            <button onclick="closeModal()" style="width:100%; padding:10px; margin-top:10px; background:#222; color:white; border:none">ƒê√ìNG</button>
        </div>
    </div>

    <script>
        const DEFAULT_IMG = "https://media.discordapp.net/attachments/1472992341156434219/1472992415303340276/Picsart_26-02-16_14-27-25-185.jpg";
        let allScripts = [], currentTab = "ALL", currentScriptText = "";

        async function fetchData() {
            const res = await fetch(`${window.location.origin}/get-hub`);
            const data = await res.json();
            allScripts = data.scripts;
            renderTabs(data.tabs);
            renderCards(allScripts);
        }

        function toggleSearch() { document.getElementById('searchContainer').classList.toggle('active'); document.getElementById('searchInput').focus(); }
        function closeSearch() { if(!document.getElementById('searchInput').value) document.getElementById('searchContainer').classList.remove('active'); }
        function toggleMenu() { document.getElementById('tabsOverlay').classList.toggle('open'); }

        function renderTabs(tabs) {
            const list = document.getElementById('tabList');
            list.innerHTML = `<button class="tab-btn active" onclick="filterTab('ALL')">T·∫•t c·∫£</button>`;
            tabs.forEach(t => {
                list.innerHTML += `<button class="tab-btn" onclick="filterTab('${t.Name}')">${t.Name}</button>`;
            });
        }

        function renderCards(scripts) {
            const grid = document.getElementById('grid');
            grid.innerHTML = "";
            scripts.forEach(s => {
                const ratioClass = s.ratio || "ratio-9-16";
                const img = s.img || DEFAULT_IMG;
                grid.innerHTML += `
                    <div class="script-card ${ratioClass}" onclick="openInfo('${s.name}', '${img}', '${s.script}', '${s.describe}')">
                        <img src="${img}" class="card-img" onerror="this.src='${DEFAULT_IMG}'">
                        <div class="card-name">${s.name}</div>
                    </div>
                `;
            });
        }

        function filterTab(t) { currentTab = t; toggleMenu(); applyFilters(); }
        document.getElementById('searchInput').oninput = applyFilters;

        function applyFilters() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            const filtered = allScripts.filter(s => (currentTab === "ALL" || s.tab === currentTab) && s.name.toLowerCase().includes(q));
            renderCards(filtered);
        }

        function openInfo(name, img, code, desc) {
            document.getElementById('modalTitle').innerText = name;
            document.getElementById('modalImg').src = img;
            document.getElementById('modalDesc').innerText = desc;
            currentScriptText = code;
            document.getElementById('infoModal').style.display = 'flex';
        }
        function closeModal() { document.getElementById('infoModal').style.display = 'none'; }
        function copyScript() { navigator.clipboard.writeText(currentScriptText); alert("ƒê√£ copy!"); }

        fetchData();
    </script>
</body>
</html>
